# Generated by the windmill services transformer
from windmill.authoring import WindmillTestClient

def test_dragdropunit():
    client = WindmillTestClient(__name__)

    client.open(url=u'http://tutorial.getwindmill.com/windmill-unittests/jqueryui152/demos/functional/index.html')
    client.waits.forPageLoad(timeout=u'40000')
    client.waits.forElement(link=u'Draggable', timeout=u'40000')
    #test the draggable widgets
    client.click(link=u'Draggable')
    client.dragDropElem(pixels=u'(200,0)', id=u'dragImage')
    client.waits.sleep(milliseconds=u'500')
    client.dragDropElem(pixels=u'(300,0)', id=u'divDrag')
    #client.asserts.assertProperty(validator=u'style.left|289px', id=u'divDrag')
    client.dragDropElem(xpath="//div[@id='draggable-handle-div']/div[1]", pixels='(257,0)')
    #client.asserts.assertProperty(validator=u'style.left|246px', id=u'draggable-handle-div')
    client.dragDropElem(link=u'Drag me', pixels=u'(420,0)')
    #client.asserts.assertProperty(validator=u'style.left|409px', id=u'draggable-dragPrevention')
    #test the droppable widgets
    client.click(link=u'Droppable')
    client.click(link=u'Droppable')
    client.waits.sleep(milliseconds=u'500')
    client.dragDropElem(xpath="//div[@id='droppablePhotos']/ul/li[2]/img", pixels='(310,0)')
    client.waits.sleep(milliseconds=u'800')
    client.asserts.assertProperty(xpath="//div[@id='droppablePhotos']/div/img", validator='src|templates/images/P1010039.JPG')
    client.dragDropElemToElem(xpath="//div[@id='droppablePhotos']/ul/li/img", optxpath="//div[@id='droppablePhotos']/div/img")
    client.waits.sleep(milliseconds=u'500')
    client.asserts.assertProperty(xpath="//div[@id='droppablePhotos']/div/img", validator='src|P1010020.JPG')
    client.dragDropElemToElem(xpath="//div[@id='ui-gen-7']/div[3]/div[1]", optxpath="//div/div[3]/div[4]")
    client.waits.sleep(milliseconds=u'500')
    client.dragDropElemToElem(xpath="//div/div[3]/div[2]", optxpath="//div/div[3]/div[4]")
    client.waits.sleep(milliseconds=u'500')
    client.asserts.assertText(xpath="//div/div[3]/div[4]", validator='Dropped!')
    client.dragDropElem(xpath="//div/div[3]/div[2]", pixels='(0,200)')
    client.waits.sleep(milliseconds=u'500')
    client.asserts.assertText(xpath=u"//div/div[3]/div[4]", validator=u'Dropped! Dropped!')
    #test the sortable widgets
    client.click(link=u'Sortable')
    client.click(link=u'Sortable')
    client.waits.sleep(milliseconds=u'500')
    client.asserts.assertJS(js=u"_w.document.getElementById('user_Susan').parentNode.childNodes.length == 11;")
    client.dragDropElem(pixels=u'(160,0)', id=u'user_Susan')
    client.asserts.assertJS(js=u"_w.document.getElementById('user_Susan').parentNode.childNodes.length == 12;")
    #test the dialog widgets
    client.click(link=u'Dialog')
    client.click(link=u'Dialog')
    client.dragDropElem(xpath="//body[@id='functional_demos']/div[3]/div[1]/div[1]", pixels='(150,0)')
    #test the slider widgets
    client.click(link=u'Slider')
    client.click(link=u'Slider')
    client.waits.sleep(milliseconds=u'500')
    client.dragDropElem(xpath="//div[@id='slider3']/a/div", pixels='(80,0)')
    client.dragDropElem(xpath="//div[@id='slider1']/a[1]/div", pixels='(50,0)')
    client.waits.sleep(milliseconds=u'500')
    client.dragDropElem(xpath="//div[@id='slider1']/a[2]/div", pixels='(-20,0)')    
    client.click(link=u'Draggable')
