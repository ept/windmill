<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
	<title>Windmill IDE</title>
	
	<link rel="stylesheet" type="text/css" href="ide/css/windmill.css"/>
	<link rel="stylesheet" type="text/css" href="ide/css/remote.css"/>
  <link rel="stylesheet" type="text/css" href="ide/css/interpreter.css"/>
	
    <script type="text/javascript" src="lib/MochiKit/MochiKit.js"></script>
    <script type="text/javascript" src="lib/interpreter.js"></script>
	  <script type="text/javascript" src="lib/browserdetect.js"></script>
  	<script type="text/javascript" src="lib/fleegix.js"></script>
    <script type="text/javascript" src="lib/interpreter.js"></script>

	<script type="text/javascript" charset="utf-8">
		//If the user went directly to remote.html
		try {
			var windmill = opener.windmill;
			var testingApp = opener.windmill.testingApp;
		}
		catch(error){
			document.location = '/windmill-serv/start.html';
		}
		var $ = function(id) {
		  return document.getElementById(id);
		};
		
		var closeDialog = function(id){
			$(id).style.display = 'none';
			$('gray').style.visibility = 'hidden';
		};
		var openDialog = function(id){
			$(id).style.display = 'block';
			$('gray').style.visibility = 'visible';
		};
		
		var toggleRec = function(){
			if ($('record').src.indexOf("ide/img/record.png")  != -1){
				opener.windmill.ui.recorder.recordOn();
				opener.window.focus();
				$('record').src = 'ide/img/stoprecord.png';
			}
			else{
				opener.windmill.ui.recorder.recordOff();
				$('record').src = 'ide/img/record.png';
			}
		}
		var togglePlay = function(){
			if ($('playback').src.indexOf("ide/img/playback.png")  != -1){
				opener.windmill.xhr.startJsonLoop();
				opener.windmill.ui.playback.sendPlayBack();				
				$('playback').src = 'ide/img/playbackstop.png';
			}
			else{
				$('playback').src = 'ide/img/playback.png';
			}
		}
		var toggleLoop = function(){
			if ($('loopLink').innerHTML.indexOf('Pause') != -1){
				$('loopLink').innerHTML = 'Resume Loop';
				opener.windmill.xhr.togglePauseJsonLoop();
			}
			else{
				$('loopLink').innerHTML = 'Pause Loop';
				opener.windmill.xhr.togglePauseJsonLoop();
			}
			
		}
		var toggleExplore = function(){
			if ($('explorer').src.indexOf("ide/img/xon.png")  != -1){
				$('domExp').style.visibility = 'visible';
				$('domExp').innerHTML = '';
				opener.windmill.ui.domexplorer.domExplorerOn();
				opener.window.focus();
				$('explorer').src = 'ide/img/xoff.png';

			}
			else {
				$('domExp').style.visibility = 'hidden';
				opener.windmill.ui.domexplorer.domExplorerOff();
				$('explorer').src = 'ide/img/xon.png';
				$('domExp').innerHTML = '';

			}
		}
		var toggleAExplore = function(){

			if ($('assertx').src.indexOf("ide/img/axon.png")  != -1){
				windmill.remote.alert('This feature is currently under development, and only about 1/4 implemented');

				$('domExp').style.visibility = 'visible';
				$('domExp').innerHTML = '';
				opener.windmill.ui.assertexplorer.assertExplorerOn();
				opener.window.focus();
				$('assertx').src = 'ide/img/axoff.png';

			}
			else {
				$('domExp').style.visibility = 'hidden';
				opener.windmill.ui.assertexplorer.assertExplorerOff();
				$('assertx').src = 'ide/img/axon.png';
				$('domExp').innerHTML = '';

			}
		}
		
		//Scrolling rules when using the IDE
		//This is a pretty insane hack, description inline
		var scroll = function(){
				//When someone scrolls we are assuming they no longer want it to jump to the bottom
				//So here I am turning the auto scrolling off
				//However if they scroll back to the bottom, we want to turn auto scroll on
				$('autoScroll').checked = false;

				var ide = $('ide');
				var a = ide.scrollTop;
				var b = ide.scrollHeight - ide.offsetHeight + 1;
				var c = a - b;
				
				//If this offset that I get from the above math is less than 4
				//Then they are back at the bottom and we turn auto scroll back on
				if (Math.abs(c) < 4){
					$('autoScroll').checked = true;
				}
				//If not we keep auto scroll off
				else{
					$('autoScroll').checked = false;
				}
		}
		
		windmill.remote = parent.window;
    windmill.remote.init = function () {
      interpreterManager.initialize();
  		opener.windmill.Start();

    };
	  fleegix.event.listen(window, 'onload', windmill.remote, 'init');
	</script>
</head>
		
<body>
<div id="main">
	&nbsp
	<img border=no style="height:41px;width:40px;" src="ide/img/wmIcon.png" alt="Welcome to Windmill!">
	<div id="runningStatus" align="center"><b>Status:</b> Nothing yet..</div>
	
	<div id="controllers">
		<a href="#" title="Toggle Recorder"><img height="28px" width="28px" alt="Toggle Recorder" name='record' id="record" border=no src="ide/img/record.png" onClick="toggleRec();" ></a>
		&nbsp<a href="#" title="Play All"><img height="28px" width="28px" alt="Play All" name ='playback' id="playback" border=no src="ide/img/playback.png" onClick="togglePlay();"></a>
		&nbsp<a href="#" title="Toggle DOM Explorer"><img height="28px" width="28px" alt="Toggle DOM Explorer" name ='explorer' id="explorer" border=no src="ide/img/xon.png" onClick="toggleExplore();"></a>
		&nbsp<a href="#" title="Toggle Assert Explorer"><img height="28px" width="28px" alt="Toggle Assert Explorer" name ='assertx' id="assertx" border=no src="ide/img/axon.png" onClick="toggleAExplore();"></a>
	</div>
	
	<div id="domExp">
	</div>
	
	<div id="ide" onscroll="scroll();">
		<form id="ideForm" name="ideForm">
		</form>
	</div>
	
	<div id="navigation" style="font-wight:bold;" align=center>
		<span style="font-weight: bold;"> 
			<a href="#" onclick="javascript:openDialog('console')">Console</a>&nbsp 
			<a href="#" onclick="javascript:openDialog('output')">Output</a>&nbsp 
			<a href="#" onclick="javascript:openDialog('settings')">Settings</a>&nbsp
		</span>
		<span>|
			<a href="#" onclick="opener.windmill.ui.incRecSuite();windmill.ui.remote.getSuite();">New Suite</a>&nbsp
			<a href="#" onclick="windmill.ui.remote.addAction();">New Action</a>&nbsp | &nbsp
		  <a href="#" onclick="windmill.ui.remote.clearIDE()">Clear IDE</a>&nbsp
		</span>
	</div>
	
</div>
<div id="gray"></div>

<div id="output" class="dialog">
		<div align="right">
			<table border="0" cellspacing="0" cellpadding="2" style="width:100%;">
				<tr>
					<td align="left" style="width:92%;color:#456068;">
						<strong>Output</strong>
					</td>
					<td style="font: 9pt arial;">
					  <a href="#" onclick="javascript:closeDialog('output');">Close</a>
				  </td>
				</tr>
			</table>
		</div>
		<br>
			<strong>General Output</strong>
		<br>
		<div id="tab4" class="tab"></div>
		<br>
	    <strong>Performance Output</strong>
		<br>
		<div id="tab3" class="tab"></div>
</div>
<div id="console" class="dialog">
		<div align="right">
			<table border="0" cellspacing="0" cellpadding="2" style="width:100%;">
				<tr>
					<td align="left" style="width:92%;color:#456068;">
						<strong>Windmill Console</strong>
					</td>
					<td style="font: 9pt arial;">
						<a href="#" onclick="javascript:closeDialog('console');">Close</a>
					</td>
				</tr>
			</table>
		</div>
		<br>
	  <form id="interpreter_form" autocomplete="off">
	  	<div id="interpreter_area">
	    	<div id="interpreter_output">
	    	</div>
	   </div>
	   <div id="oneline">
	       <input style="width:80%;height:5%" id="interpreter_text" name="input_text" type="text" class="textbox" size="58" />
	   </div>
	   <div id="multiline">
	     <textarea style="width:80%;height:10%;" id="interpreter_textarea" name="input_textarea" type="text" class="textbox" cols="55" rows="4">
	     </textarea>
	     <br />
	   </div>
	 </form>
</div>

<div id="settings" class="dialog">
		<form id='settingsForm' name='settingsForm'>
		<div align="right">
			<table border="0" cellspacing="0" cellpadding="2" style="width:100%;">
				<tr>
					<td align="left" style="width:92%;color:#456068;">
						<strong>Windmill Settings</strong>
					</td>
					<td style="font: 9pt arial;">
						<a href="#" onclick="javascript:closeDialog('settings');">Close</a>
					</td>
				</tr>
			</table>
		</div>
		<br>
		<h3>System</h3>
		<table style="font:14px arial;">
			<tr>
				<td>Break on failure:</td>
				<td> <INPUT TYPE=checkbox UNCHECKED ID='toggleBreak' onclick="opener.windmill.ui.toggleBreak();"></td>
			</tr>
			<tr>
				<td>Suppress Javascript Alerts:</td><td> <INPUT TYPE=checkbox UNCHECKED ID='jsAlerts'></td>
			</tr>
			<tr>
				<td>Suite Save Formatting:</td>
				<td> 
					<SELECT id="suiteSaveFormat" NAME="suiteSaveFormat">
						<OPTION value="python" selected>python</option>
						<OPTION value="json">json</option>
					</SELECT>
				</td>
			</tr>
		</table>
		
		<h3>IDE/Recorder</h3>
		<table style="font:14px arial;">
			<tr>
				<td>Auto Scroll IDE to bottom:</td>
				<td> <INPUT TYPE=checkbox CHECKED ID='autoScroll'></td>
			</tr>
			<tr>
				<td>Absolute click sensitivity when recording:</td>
				<td><INPUT TYPE=checkbox CHECKED ID='clickOn'></td>
			</tr>
			<tr>
				<td>Action play button cascades:</td>
				<td> <INPUT TYPE=checkbox CHECKED ID='playCascade'></td>
			</tr>
		</table>
		<br><br>
		<a href='#' onclick="opener.windmill.testingApp.document.location.reload()">Reload Testing Application</a>: This reloads your page, without resetting Windmill.
		<br><br><br><br>
		<div id="loopButton" style="font:18px arial;width:100%;">
			<center>
				<a id="loopLink" href = "#" onclick="javascript:toggleLoop();">Pause Loop</a>
			</center>
		</div>
	</form>
</div>

</body>
</html>
